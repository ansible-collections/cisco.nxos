---
- ansible.builtin.debug:
    msg: START nxapi/badtransport.yaml

- name: Sending transport other than CLI should fail
  register: result
  ignore_errors: true
  cisco.nxos.nxos_nxapi:
    enable_http: false
    enable_sandbox: false
    https_port: 9443

- ansible.builtin.assert:
    that:
      - result.failed and result.msg is search('transport')
  when: ansible_connection == 'ansible.netcommon.httpapi'

- ansible.builtin.assert:
    that:
      - result.changed
      - "'no nxapi http' in result.commands"
  when: ansible_connection == 'ansible.netcommon.network_cli'

- ansible.builtin.debug:
    msg: END nxapi/badtransport.yaml

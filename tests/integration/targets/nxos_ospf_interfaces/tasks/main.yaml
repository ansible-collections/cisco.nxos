---
- name: Enable ospf v2 and v3 features
  cisco.nxos.nxos_config:
    lines:
      - feature ospf
      - feature ospfv3
  vars:
    ansible_connection: ansible.netcommon.network_cli

- block:
    - name: Include the cli tasks
      ansible.builtin.include_tasks: cli.yaml
      tags:
        - cli.yaml

    - name: Include the nx-api tasks
      ansible.builtin.include_tasks: nxapi.yaml
      tags:
        - nxapi

  always:
    - name: Disable ospf v2 and v3 features
      cisco.nxos.nxos_config:
        lines:
          - feature ospf
          - feature ospfv3
      vars:
        ansible_connection: ansible.netcommon.network_cli
